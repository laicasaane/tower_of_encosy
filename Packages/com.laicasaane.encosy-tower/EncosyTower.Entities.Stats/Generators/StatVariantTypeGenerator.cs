#if UNITY_EDITOR && ANNULUS_CODEGEN && ENCOSY_STAT_VALUE_TYPES_GENERATOR

using System;
using EncosyTower.CodeGen;
using UnityCodeGen;

namespace EncosyTower.Entities.Stats.Generators
{
    [Generator]
    internal sealed class StatVariantTypeGenerator : ICodeGenerator
    {
        public void Execute(GeneratorContext context)
        {
            var p = Printer.DefaultLarge;
            p.PrintAutoGeneratedBlock(nameof(StatVariantTypeGenerator));
            p.PrintEndLine();
            p.PrintLine(@"#pragma warning disable

using EncosyTower.EnumExtensions;
using Unity.Mathematics;
");

            p.PrintLine("namespace EncosyTower.Entities.Stats");
            p.OpenScope();
            {
                var types = GeneratorAPI.Types.AsSpan();
                var typeNames = GeneratorAPI.TypeNames.AsSpan();
                var sizes = GeneratorAPI.Sizes.AsSpan();

                p.PrintLine("/// <summary>");
                p.PrintLine("/// Represents a collection of supported value types that can be used in this stat system.");
                p.PrintLine("/// </summary>");
                p.PrintLine("[EnumExtensions]");
                p.PrintLine("public enum StatVariantType : byte");
                p.OpenScope();
                {
                    for (var i = 0; i < typeNames.Length; i++)
                    {
                        var type = types[i];
                        var typeName = typeNames[i];
                        var size = sizes[i];

                        p.PrintLine("/// <summary>");
                        p.PrintBeginLine("/// <see cref=\"").Print(types[i]).Print("\"/> | ").Print(size)
                            .PrintEndLineSelect(" bytes.", " byte.", size > 1);
                        p.PrintLine("/// </summary>");
                        p.PrintBeginLine(typeName).Print(" = ").Print(i).PrintEndLine(",");
                        p.PrintEndLine();
                    }
                }
                p.CloseScope();
                p.PrintEndLine();

                p.PrintLine("partial interface IStatVariantTypeExtensions { }");
                p.PrintEndLine();

                p.PrintLine("partial struct StatVariantTypeExtended { }");
                p.PrintEndLine();

                p.PrintLine("static partial class StatVariantTypeExtensions");
                p.OpenScope();
                {
                    p.PrintLine("partial class DisplayNames { }");
                    p.PrintEndLine();

                    p.PrintLine("partial class FixedDisplayNames { }");
                    p.PrintEndLine();

                    p.PrintLine("partial class FixedNames { }");
                    p.PrintEndLine();

                    p.PrintLine("partial class Names { }");
                    p.PrintEndLine();

                    p.PrintLine("partial class UnderlyingValues { }");
                    p.PrintEndLine();

                    p.PrintLine("partial class Values { }");
                    p.PrintEndLine();
                }
                p.CloseScope();
                p.PrintEndLine();
            }
            p.CloseScope();
            p.PrintEndLine();

            context.OverrideFolderPath(CodeGenAPI.GetOutputFolderPathFromCaller(pathCombine: GeneratorAPI.COMMON_FOLDER));
            context.AddCode($"StatVariantType.gen.cs", p.Result);
        }
    }
}

#endif
